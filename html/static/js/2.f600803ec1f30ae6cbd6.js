webpackJsonp([2],{"1k4n":function(t,e){},"7wjL":function(t,e){},ar2U:function(t,e,l){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a={computed:{blogData:function(){return this.$store.state.newBlogForm}},data:function(){return{filelist:[],blogData2:Object(null),imageUrl:"",newBlogForm:[]}},methods:{submit:function(){this.$refs.upload.submit()},imgPreview:function(t,e){this.imageUrl=URL.createObjectURL(t.raw),this.blogData2=Object(this.$store.state.newBlogForm)},handleAvatarSuccess:function(t,e){alert("发表成功"),this.$parent.$parent.$parent.all_close()},beforeAvatarUpload:function(t){console.log("上传之前的携带数据："),console.log(this.blogData2),console.log(this.filelist);var e="image/jpeg"===t.type,l=t.size/1024/1024<4;return e||this.$message.error("上传头像图片只能是 JPG 格式!"),l||this.$message.error("上传头像图片大小不能超过 4MB!"),e&&l}},created:function(){this.filelist=this.$store.state.newBlogImgs}},i={render:function(){var t=this,e=t.$createElement,l=t._self._c||e;return l("div",[l("el-upload",{ref:"upload",staticClass:"avatar-uploader",attrs:{name:"head",action:"/api2/blogs/addNewBlog","show-file-list":!0,"file-list":t.filelist,data:t.blogData2,"auto-upload":!1,"on-change":t.imgPreview,"on-success":t.handleAvatarSuccess,"before-upload":t.beforeAvatarUpload}},[t.imageUrl?l("img",{staticClass:"avatar",attrs:{src:t.imageUrl}}):l("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]),t._v(" "),l("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.submit()}}},[t._v("确认发表")])],1)},staticRenderFns:[]};var o=l("VU/8")(a,i,!1,function(t){l("7wjL")},null,null).exports,n={props:{contentFromDad:{type:String}},components:{"my-upblogpicture":o},data:function(){return{dialogFormVisible:!1,child_dialogFormVisible:!1,form:{title:"",maintype:"",date1:"",date2:"",content:"",isPublic:!0,tag:[],note:""}}},methods:{test2:function(){console.log(this.form.tag)},onSubmit:function(){console.log("submit!")},addNewBlogFormFun:function(){this.$store.dispatch("addNewBlogFormFun",this.form),this.child_dialogFormVisible=!0},all_close:function(){this.child_dialogFormVisible=!1,this.dialogFormVisible=!1}}},r={render:function(){var t=this,e=t.$createElement,l=t._self._c||e;return l("el-dialog",{staticStyle:{"text-align":"left"},attrs:{title:"上传文章",visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[l("el-dialog",{attrs:{width:"30%",title:"为博客添加导览图",visible:t.child_dialogFormVisible,"append-to-body":""},on:{"update:visible":function(e){t.child_dialogFormVisible=e}}},[l("my-upblogpicture",{ref:"up_picture",staticStyle:{"text-align":"center"}})],1),t._v(" "),l("el-form",{ref:"form",attrs:{model:t.form,"label-width":"80px"}},[l("el-form-item",{attrs:{label:"文章标题"}},[l("el-input",{model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1),t._v(" "),l("el-form-item",{attrs:{label:"主要类型"}},[l("el-select",{attrs:{placeholder:"请选择活动区域"},model:{value:t.form.maintype,callback:function(e){t.$set(t.form,"maintype",e)},expression:"form.maintype"}},[l("el-option",{attrs:{label:"技术",value:"技术"}}),t._v(" "),l("el-option",{attrs:{label:"生活",value:"生活"}})],1)],1),t._v(" "),l("el-form-item",{attrs:{label:"时间"}},[l("el-col",{attrs:{span:11}},[l("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择日期"},model:{value:t.form.date1,callback:function(e){t.$set(t.form,"date1",e)},expression:"form.date1"}})],1),t._v(" "),l("el-col",{staticClass:"line",attrs:{span:2}},[t._v("-")]),t._v(" "),l("el-col",{attrs:{span:11}},[l("el-time-picker",{staticStyle:{width:"100%"},attrs:{placeholder:"选择时间"},model:{value:t.form.date2,callback:function(e){t.$set(t.form,"date2",e)},expression:"form.date2"}})],1)],1),t._v(" "),l("el-form-item",{attrs:{label:"是否公开"}},[l("el-switch",{model:{value:t.form.isPublic,callback:function(e){t.$set(t.form,"isPublic",e)},expression:"form.isPublic"}})],1),t._v(" "),l("el-form-item",{attrs:{label:"标签"}},[l("el-checkbox-group",{model:{value:t.form.tag,callback:function(e){t.$set(t.form,"tag",e)},expression:"form.tag"}},[l("el-checkbox",{attrs:{label:"前端",name:"tag"}}),t._v(" "),l("el-checkbox",{attrs:{label:"算法/数据结构",name:"tag"}}),t._v(" "),l("el-checkbox",{attrs:{label:"后端",name:"tag"}}),t._v(" "),l("el-checkbox",{attrs:{label:"其他",name:"tag"}})],1)],1),t._v(" "),l("el-form-item",{attrs:{label:"备注"}},[l("el-input",{attrs:{type:"textarea"},model:{value:t.form.note,callback:function(e){t.$set(t.form,"note",e)},expression:"form.note"}})],1),t._v(" "),l("el-form-item",[l("el-button",{attrs:{type:"primary"},on:{click:t.addNewBlogFormFun}},[t._v("确认")]),t._v(" "),l("el-button",{on:{click:function(e){return t.test2()}}},[t._v("取消")])],1)],1)],1)},staticRenderFns:[]},s={components:{"my-uploadblog":l("VU/8")(n,r,!1,null,null,null).exports},data:function(){return{loading:!1,value:"",defaultData:"preview",title:"",img_file:[]}},methods:{change:function(t){this.$forceUpdate()},open:function(){this.$refs.child.dialogFormVisible=!0,this.$refs.child.form.title=this.title,this.$refs.child.form.content=this.value},$imgAdd:function(t,e){this.img_file[t]=e},$imgDel:function(t){delete this.img_file[t[0]]},addPictures:function(){var t=this;if(!this.$store.state.isLogin)return this.$message.error("请登录，不然无法使用发表功能"),0;this.loading=!0;var e=new FormData;for(var l in this.img_file)e.append(l,this.img_file[l]);e.append("_img"," this.img_file[_img]"),this.$axios({url:"/api2/blogs/Picture_url",method:"post",data:e,headers:{"Content-Type":"multipart/form-data"}}).then(function(e){for(var l in console.log(e),e.data.data){var a=e.data.data[l][0],i=e.data.data[l][1];t.$refs.md.$img2Url(a,i)}t.loading=!1,t.open()})}},mounted:function(){this.$store.state.isLogin||this.$message({message:"您尚未登录，不可以使用发表功能",type:"warning"})}},c={render:function(){var t=this,e=t.$createElement,l=t._self._c||e;return l("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{"element-loading-text":"正在等待博客里的图片上传哦······","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)"}},[l("div",{staticClass:"title-up",staticStyle:{padding:"10px 10px 10px 10px","background-color":"#47484a"}},[l("el-row",{attrs:{gutter:20}},[l("el-col",{attrs:{span:16}},[l("el-input",{staticStyle:{display:"inline-block"},attrs:{type:"text",placeholder:"请输入文本标题",maxlength:"50","show-word-limit":""},on:{input:function(e){return t.change(e)}},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}})],1),t._v(" "),l("el-col",{attrs:{span:8}},[l("el-button",{attrs:{type:"info",plain:""}},[t._v("保存为草稿")]),t._v(" "),l("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.addPictures()}}},[t._v("发表博客")])],1)],1)],1),t._v(" "),l("mavon-editor",{ref:"md",attrs:{ishljs:!0},on:{imgAdd:t.$imgAdd,imgDel:t.$imgDel},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}}),t._v(" "),l("my-uploadblog",{ref:"child",attrs:{contentFromDad:t.value}})],1)},staticRenderFns:[]};var d=l("VU/8")(s,c,!1,function(t){l("1k4n")},null,null);e.default=d.exports}});
//# sourceMappingURL=2.f600803ec1f30ae6cbd6.js.map